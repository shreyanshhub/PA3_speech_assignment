True
training and val size: (1600, 80000) (400, 80000) (1600,)
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda'
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda' with weights_only=False
[Epoch 0]
Train loss: 4.0214715003967285
0.013157894736842105
Test loss: 3.969460964202881
TEST average_precision: 0.00044077134986225897
TEST average recall: 0.02
TEST average f1: 0.000862533692722372
[Epoch 1]
Train loss: 3.9084861278533936
0.07894736842105263
Test loss: 3.915213108062744
TEST average_precision: 0.0016509988249118685
TEST average recall: 0.0275
TEST average f1: 0.0030600104175233706
[Epoch 2]
Train loss: 3.9450290203094482
0.013513513513513514
Test loss: 3.9397647380828857
TEST average_precision: 0.0013370288248337027
TEST average recall: 0.0325
TEST average f1: 0.002566299469604243
[Epoch 3]
Train loss: 3.831244945526123
0.038461538461538464
Test loss: 3.8883473873138428
TEST average_precision: 0.004792148782826824
TEST average recall: 0.04
TEST average f1: 0.007095785440613027
[Epoch 4]
Train loss: 3.9090397357940674
0.058823529411764705
[Epoch 5]
Train loss: 3.8708951473236084
0.0
[Epoch 6]
Train loss: 3.8135082721710205
0.041666666666666664
[Epoch 7]
Train loss: 3.903925895690918
0.012857142857142857
Test loss: 3.736393690109253
TEST average_precision: 0.03184699816874705
TEST average recall: 0.0625
TEST average f1: 0.03000387112887113
[Epoch 8]
Train loss: 3.5700037479400635
0.041666666666666664
[Epoch 9]
Train loss: 3.325779438018799
0.08547008547008546
Test loss: 3.6347644329071045
TEST average_precision: 0.09518427898061767
TEST average recall: 0.1175
TEST average f1: 0.06890752231657805
[Epoch 10]
Train loss: 2.914062023162842
0.22058823529411764
Test loss: 2.795673370361328
TEST average_precision: 0.25653745013156776
TEST average recall: 0.2125
TEST average f1: 0.17193800252073707
[Epoch 11]
Train loss: 2.6403002738952637
0.31140350877192985
Test loss: 2.336881399154663
TEST average_precision: 0.3225662703767967
TEST average recall: 0.3625
TEST average f1: 0.3101524867100315
[Epoch 12]
Train loss: 2.315748929977417
0.26944444444444443
Test loss: 1.6739016771316528
TEST average_precision: 0.4968818201062783
TEST average recall: 0.415
TEST average f1: 0.39227241619699554
[Epoch 13]
Train loss: 1.8996551036834717
0.3969298245614035
Test loss: 1.993022084236145
TEST average_precision: 0.45675520688461857
TEST average recall: 0.4625
TEST average f1: 0.43276716655822023
[Epoch 14]
Train loss: 1.6244261264801025
0.4893162393162393
Test loss: 1.6896007061004639
TEST average_precision: 0.468980163111742
TEST average recall: 0.4775
TEST average f1: 0.4475405531163373
[Epoch 15]
Train loss: 1.7617107629776
0.5523809523809523
Test loss: 1.4936838150024414
TEST average_precision: 0.5036179588385471
TEST average recall: 0.485
TEST average f1: 0.463834152649821
[Epoch 16]
Train loss: 0.8719837665557861
0.8183760683760685
Test loss: 1.049699306488037
TEST average_precision: 0.5691213081723917
TEST average recall: 0.525
TEST average f1: 0.516540323144348
[Epoch 17]
Train loss: 0.8082872629165649
0.7384615384615385
Test loss: 1.1892930269241333
TEST average_precision: 0.6175721778221779
TEST average recall: 0.58
TEST average f1: 0.5637591578939001
[Epoch 18]
Train loss: 0.9883820414543152
0.7107843137254901
[Epoch 19]
Train loss: 0.82460618019104
0.7850877192982456
[Epoch 20]
Train loss: 0.8190158009529114
0.7557017543859649
[Epoch 21]
Train loss: 0.59726482629776
0.7927350427350427
[Epoch 22]
Train loss: 0.5112631916999817
0.7800925925925926
Test loss: 1.5076959133148193
TEST average_precision: 0.6139554569957046
TEST average recall: 0.595
TEST average f1: 0.5718180570375617
[Epoch 23]
Train loss: 0.5673494338989258
0.8480392156862745
[Epoch 24]
Train loss: 0.6175749897956848
0.7905982905982906
Test loss: 1.185238242149353
TEST average_precision: 0.644254477548595
TEST average recall: 0.6125
TEST average f1: 0.6020377043694852
[Epoch 25]
Train loss: 0.53070467710495
0.8875
[Epoch 26]
Train loss: 0.45862722396850586
0.8268817204301075
[Epoch 27]
Train loss: 0.4056374430656433
0.8055555555555555
[Epoch 28]
Train loss: 0.3007458448410034
0.9261904761904761
[Epoch 29]
Train loss: 0.22121119499206543
0.96875
Test loss: 1.0379576683044434
TEST average_precision: 0.6713172905525847
TEST average recall: 0.625
TEST average f1: 0.6170139788689795
[Epoch 30]
Train loss: 0.3517604172229767
0.8423423423423423
[Epoch 31]
Train loss: 0.22334569692611694
0.9436936936936936
[Epoch 32]
Train loss: 0.3698342442512512
0.8979166666666666
[Epoch 33]
Train loss: 0.13370127975940704
0.9761904761904762
Test loss: 1.1791300773620605
TEST average_precision: 0.6542667363596156
TEST average recall: 0.6425
TEST average f1: 0.6276598062581641
[Epoch 34]
Train loss: 0.10763923823833466
0.9619047619047618
[Epoch 35]
Train loss: 0.11829983443021774
0.911111111111111
[Epoch 36]
Train loss: 0.1810857057571411
0.9358974358974359
[Epoch 37]
Train loss: 0.11728827655315399
0.9785714285714285
[Epoch 38]
Train loss: 0.1373375654220581
0.9671717171717171
[Epoch 39]
Train loss: 0.35946395993232727
0.9407894736842105
[Epoch 40]
Train loss: 0.04956600069999695
0.9901960784313725
[Epoch 41]
Train loss: 0.2008398026227951
0.9210526315789473
[Epoch 42]
Train loss: 0.0416930615901947
0.991869918699187
[Epoch 43]
Train loss: 0.033878449350595474
0.9857142857142858
Finished Training
training and val size: (1600, 80000) (400, 80000) (1600,)
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda'
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda' with weights_only=False
[Epoch 0]
Train loss: 3.9301023483276367
0.04861111111111111
Test loss: 3.959270715713501
TEST average_precision: 0.020416666666666666
TEST average recall: 0.0225
TEST average f1: 0.005260770975056689
[Epoch 1]
Train loss: 3.8832950592041016
0.0625
Test loss: 3.811645746231079
TEST average_precision: 0.026755881387460337
TEST average recall: 0.0475
TEST average f1: 0.012517976691351303
[Epoch 2]
Train loss: 3.829017162322998
0.027777777777777776
[Epoch 3]
Train loss: 3.752788543701172
0.061403508771929814
Test loss: 3.5177488327026367
TEST average_precision: 0.01556286033532592
TEST average recall: 0.07
TEST average f1: 0.022899901418238323
[Epoch 4]
Train loss: 3.599929094314575
0.016203703703703703
Test loss: 4.037958145141602
TEST average_precision: 0.03749833848028463
TEST average recall: 0.0825
TEST average f1: 0.03784962891842317
[Epoch 5]
Train loss: 2.968745708465576
0.20833333333333334
Test loss: 3.0724332332611084
TEST average_precision: 0.14340869994254202
TEST average recall: 0.185
TEST average f1: 0.12925220586259478
[Epoch 6]
Train loss: 2.5843169689178467
0.2452380952380952
Test loss: 2.866602897644043
TEST average_precision: 0.2112273402589192
TEST average recall: 0.2125
TEST average f1: 0.1826603543901296
[Epoch 7]
Train loss: 2.207416534423828
0.3449074074074074
Test loss: 2.710545063018799
TEST average_precision: 0.41524145974602367
TEST average recall: 0.4025
TEST average f1: 0.3678661961462232
[Epoch 8]
Train loss: 1.6919242143630981
0.6161616161616161
[Epoch 9]
Train loss: 1.637230396270752
0.5853658536585366
Test loss: 2.4369096755981445
TEST average_precision: 0.5280448066095125
TEST average recall: 0.4875
TEST average f1: 0.46487547365961696
[Epoch 10]
Train loss: 1.4879117012023926
0.587719298245614
Test loss: 2.4229049682617188
TEST average_precision: 0.5239542059247941
TEST average recall: 0.51
TEST average f1: 0.49145472002820134
[Epoch 11]
Train loss: 0.881437361240387
0.8018018018018017
Test loss: 1.8587183952331543
TEST average_precision: 0.5609745196324144
TEST average recall: 0.555
TEST average f1: 0.5337358860609634
[Epoch 12]
Train loss: 0.8199994564056396
0.7454954954954954
Test loss: 3.1108007431030273
TEST average_precision: 0.5920335775335775
TEST average recall: 0.5625
TEST average f1: 0.5421099367164276
[Epoch 13]
Train loss: 0.7715898156166077
0.7612612612612613
Test loss: 3.3509163856506348
TEST average_precision: 0.5913713231213231
TEST average recall: 0.5675
TEST average f1: 0.5533692585897668
[Epoch 14]
Train loss: 0.4214830994606018
0.8662280701754387
Test loss: 2.8612728118896484
TEST average_precision: 0.6284956709956709
TEST average recall: 0.58
TEST average f1: 0.5666477721736842
[Epoch 15]
Train loss: 0.49286121129989624
0.875
[Epoch 16]
Train loss: 0.5116385221481323
0.8425925925925927
[Epoch 17]
Train loss: 0.4113948941230774
0.9188034188034186
Test loss: 3.8173530101776123
TEST average_precision: 0.6738847645302753
TEST average recall: 0.6
TEST average f1: 0.6027621402329527
[Epoch 18]
Train loss: 0.29671722650527954
0.8842592592592592
[Epoch 19]
Train loss: 0.4941961467266083
0.8566666666666667
[Epoch 20]
Train loss: 0.284374475479126
0.8859649122807017
Test loss: 4.259169578552246
TEST average_precision: 0.6776147186147188
TEST average recall: 0.615
TEST average f1: 0.605678321334668
[Epoch 21]
Train loss: 0.31570860743522644
0.9324324324324325
[Epoch 22]
Train loss: 0.22865039110183716
0.9230769230769231
[Epoch 23]
Train loss: 0.3542630076408386
0.8648648648648649
[Epoch 24]
Train loss: 0.28958559036254883
0.9
[Epoch 25]
Train loss: 0.24266111850738525
0.9298245614035087
Test loss: 3.8008766174316406
TEST average_precision: 0.6858540283246165
TEST average recall: 0.6275
TEST average f1: 0.6221887704598837
[Epoch 26]
Train loss: 0.19541169703006744
0.9027777777777778
[Epoch 27]
Train loss: 0.16847187280654907
0.9539473684210527
[Epoch 28]
Train loss: 0.08480525016784668
0.9607843137254901
[Epoch 29]
Train loss: 0.2203376591205597
0.9799999999999999
[Epoch 30]
Train loss: 0.23480650782585144
0.9657407407407407
[Epoch 31]
Train loss: 0.0877092033624649
0.9736842105263158
Test loss: 4.488173961639404
TEST average_precision: 0.6938162948162947
TEST average recall: 0.645
TEST average f1: 0.6424298878310185
[Epoch 32]
Train loss: 0.14041002094745636
0.9407894736842105
[Epoch 33]
Train loss: 0.06388268619775772
0.9583333333333334
Test loss: 3.8726091384887695
TEST average_precision: 0.6861027126468303
TEST average recall: 0.6475
TEST average f1: 0.6406316765141788
[Epoch 34]
Train loss: 0.06298313289880753
0.9944444444444444
[Epoch 35]
Train loss: 0.11186965554952621
0.9619047619047618
[Epoch 36]
Train loss: 0.02977396920323372
1.0
[Epoch 37]
Train loss: 0.13166913390159607
0.9629629629629629
[Epoch 38]
Train loss: 0.049204856157302856
0.9692307692307691
[Epoch 39]
Train loss: 0.10059180110692978
0.9558823529411765
[Epoch 40]
Train loss: 0.031237589195370674
0.9868421052631579
[Epoch 41]
Train loss: 0.24518342316150665
0.9102564102564102
[Epoch 42]
Train loss: 0.03807896748185158
0.9868421052631579
[Epoch 43]
Train loss: 0.0893758162856102
0.9768518518518517
Finished Training
training and val size: (1600, 80000) (400, 80000) (1600,)
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda'
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda' with weights_only=False
[Epoch 0]
Train loss: 3.9942550659179688
0.013513513513513514
Test loss: 4.019228935241699
TEST average_precision: 0.012079037800687285
TEST average recall: 0.025
TEST average f1: 0.0077777777777777776
[Epoch 1]
Train loss: 3.9494097232818604
0.02631578947368421
Test loss: 3.8018839359283447
TEST average_precision: 0.025370880522395677
TEST average recall: 0.045
TEST average f1: 0.023985092723164868
[Epoch 2]
Train loss: 3.7345993518829346
0.09285714285714286
Test loss: 3.7700650691986084
TEST average_precision: 0.028998742174097626
TEST average recall: 0.075
TEST average f1: 0.03857250446085947
[Epoch 3]
Train loss: 3.4443187713623047
0.13034188034188032
Test loss: 3.4849467277526855
TEST average_precision: 0.10729952447100154
TEST average recall: 0.1275
TEST average f1: 0.09392157287948566
[Epoch 4]
Train loss: 3.175715208053589
0.15765765765765766
Test loss: 2.548469305038452
TEST average_precision: 0.3092880129846074
TEST average recall: 0.305
TEST average f1: 0.25541778612123883
[Epoch 5]
Train loss: 2.4364566802978516
0.3803418803418803
Test loss: 1.669115662574768
TEST average_precision: 0.4905514543935596
TEST average recall: 0.435
TEST average f1: 0.4228769094380143
[Epoch 6]
Train loss: 1.674109935760498
0.5585585585585585
Test loss: 1.2326759099960327
TEST average_precision: 0.5334920357420357
TEST average recall: 0.5
TEST average f1: 0.4744284699044378
[Epoch 7]
Train loss: 1.2625454664230347
0.5220720720720721
Test loss: 1.1910229921340942
TEST average_precision: 0.5723288312994196
TEST average recall: 0.51
TEST average f1: 0.4991565674532577
[Epoch 8]
Train loss: 1.0470571517944336
0.7222222222222222
Test loss: 0.6628857254981995
TEST average_precision: 0.6607379940321116
TEST average recall: 0.5975
TEST average f1: 0.5900830437984563
[Epoch 9]
Train loss: 0.8559573888778687
0.7719298245614036
Test loss: 0.7470120191574097
TEST average_precision: 0.6584758852258852
TEST average recall: 0.6275
TEST average f1: 0.6149125427376201
[Epoch 10]
Train loss: 1.0503908395767212
0.6981981981981982
[Epoch 11]
Train loss: 0.532285749912262
0.7916666666666666
[Epoch 12]
Train loss: 0.6534138917922974
0.7991452991452991
[Epoch 13]
Train loss: 0.43686267733573914
0.8958333333333333
Test loss: 0.8241115212440491
TEST average_precision: 0.669054945054945
TEST average recall: 0.63
TEST average f1: 0.6178736554497087
[Epoch 14]
Train loss: 0.37607789039611816
0.9298245614035087
[Epoch 15]
Train loss: 0.19944432377815247
0.9662162162162162
Test loss: 0.5511102676391602
TEST average_precision: 0.6982839271839271
TEST average recall: 0.6675
TEST average f1: 0.6587330558306858
[Epoch 16]
Train loss: 0.43387123942375183
0.875
[Epoch 17]
Train loss: 0.37267374992370605
0.9125
[Epoch 18]
Train loss: 0.32916635274887085
0.881578947368421
[Epoch 19]
Train loss: 0.15203329920768738
0.9735042735042736
[Epoch 20]
Train loss: 0.22387972474098206
0.9342105263157895
[Epoch 21]
Train loss: 0.23783981800079346
0.9428571428571428
[Epoch 22]
Train loss: 0.1742219179868698
0.9431818181818182
[Epoch 23]
Train loss: 0.09155851602554321
0.9560185185185185
[Epoch 24]
Train loss: 0.27888521552085876
0.95625
[Epoch 25]
Train loss: 0.07415514439344406
0.9912280701754386
Finished Training
training and val size: (1600, 80000) (400, 80000) (1600,)
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda'
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda' with weights_only=False
[Epoch 0]
Train loss: 3.9730710983276367
0.038461538461538464
Test loss: 4.164285659790039
TEST average_precision: 0.0004
TEST average recall: 0.02
TEST average f1: 0.000784313725490196
[Epoch 1]
Train loss: 3.9156429767608643
0.014285714285714285
Test loss: 3.4398388862609863
TEST average_precision: 0.018021990177454403
TEST average recall: 0.0575
TEST average f1: 0.02130975045729144
[Epoch 2]
Train loss: 3.753798484802246
0.0375
[Epoch 3]
Train loss: 3.7633936405181885
0.06097560975609756
[Epoch 4]
Train loss: 3.6255271434783936
0.06666666666666665
Test loss: 4.087886810302734
TEST average_precision: 0.05772931736828593
TEST average recall: 0.07
TEST average f1: 0.04136862567547086
[Epoch 5]
Train loss: 3.205646514892578
0.1880952380952381
Test loss: 3.2038049697875977
TEST average_precision: 0.15085278517053433
TEST average recall: 0.2
TEST average f1: 0.14220978235336607
[Epoch 6]
Train loss: 2.7925572395324707
0.2571428571428571
Test loss: 2.7144107818603516
TEST average_precision: 0.17391271900614005
TEST average recall: 0.2625
TEST average f1: 0.18129430567048518
[Epoch 7]
Train loss: 2.219376802444458
0.4444444444444444
Test loss: 2.1475491523742676
TEST average_precision: 0.3348558104748037
TEST average recall: 0.3475
TEST average f1: 0.2982813586620485
[Epoch 8]
Train loss: 1.8393628597259521
0.5083333333333333
Test loss: 2.530400514602661
TEST average_precision: 0.38900224680509793
TEST average recall: 0.415
TEST average f1: 0.3567014403482973
[Epoch 9]
Train loss: 1.4894611835479736
0.5833333333333334
Test loss: 2.8840646743774414
TEST average_precision: 0.5169600957464735
TEST average recall: 0.48
TEST average f1: 0.4487897815320887
[Epoch 10]
Train loss: 1.5054329633712769
0.668859649122807
Test loss: 2.920675277709961
TEST average_precision: 0.5803741128152893
TEST average recall: 0.53
TEST average f1: 0.5159498560950574
[Epoch 11]
Train loss: 1.1061846017837524
0.5964912280701754
Test loss: 2.512477159500122
TEST average_precision: 0.5699500222000222
TEST average recall: 0.535
TEST average f1: 0.5162148041631335
[Epoch 12]
Train loss: 1.039223313331604
0.7267543859649123
Test loss: 2.2104697227478027
TEST average_precision: 0.5858202763868399
TEST average recall: 0.5475
TEST average f1: 0.5301396644196753
[Epoch 13]
Train loss: 0.6607044339179993
0.8034188034188035
Test loss: 3.3187923431396484
TEST average_precision: 0.6061467976467977
TEST average recall: 0.5675
TEST average f1: 0.545061272203216
[Epoch 14]
Train loss: 0.5209051966667175
0.7972972972972973
[Epoch 15]
Train loss: 0.6408912539482117
0.7938596491228069
[Epoch 16]
Train loss: 0.6482937335968018
0.8738738738738739
Test loss: 2.7735204696655273
TEST average_precision: 0.6679664721243668
TEST average recall: 0.63
TEST average f1: 0.617350157074346
[Epoch 17]
Train loss: 0.617090106010437
0.7626262626262625
[Epoch 18]
Train loss: 0.43228811025619507
0.8276190476190477
[Epoch 19]
Train loss: 0.3817020356655121
0.867117117117117
[Epoch 20]
Train loss: 0.4260818362236023
0.8194444444444444
[Epoch 21]
Train loss: 0.23300442099571228
0.9487179487179487
[Epoch 22]
Train loss: 0.20049382746219635
0.9126016260162602
Test loss: 5.385911464691162
TEST average_precision: 0.6818500943500944
TEST average recall: 0.6325
TEST average f1: 0.630868122417658
[Epoch 23]
Train loss: 0.21737627685070038
0.8686868686868686
[Epoch 24]
Train loss: 0.21012969315052032
0.9571428571428572
Test loss: 5.587457656860352
TEST average_precision: 0.6981280663780663
TEST average recall: 0.64
TEST average f1: 0.629652153398418
[Epoch 25]
Train loss: 0.20896631479263306
0.9256756756756757
[Epoch 26]
Train loss: 0.12028063088655472
0.9629629629629629
[Epoch 27]
Train loss: 0.3358616232872009
0.8963963963963963
[Epoch 28]
Train loss: 0.17464756965637207
0.9605263157894737
[Epoch 29]
Train loss: 0.14064757525920868
0.974074074074074
[Epoch 30]
Train loss: 0.15963992476463318
0.9769607843137256
Test loss: 4.075344085693359
TEST average_precision: 0.69179797979798
TEST average recall: 0.6625
TEST average f1: 0.6546949970356889
[Epoch 31]
Train loss: 0.21260584890842438
0.918918918918919
[Epoch 32]
Train loss: 0.022070445120334625
1.0
[Epoch 33]
Train loss: 0.0531318373978138
0.9861111111111112
[Epoch 34]
Train loss: 0.13438962399959564
0.9629629629629629
[Epoch 35]
Train loss: 0.05350374057888985
0.9901960784313725
[Epoch 36]
Train loss: 0.09019766747951508
0.9407894736842105
[Epoch 37]
Train loss: 0.024101028218865395
1.0
[Epoch 38]
Train loss: 0.06751895695924759
0.9605263157894737
[Epoch 39]
Train loss: 0.21709562838077545
0.9387755102040818
[Epoch 40]
Train loss: 0.10414130240678787
0.9722222222222222
Finished Training
training and val size: (1600, 80000) (400, 80000) (1600,)
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda'
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda' with weights_only=False
[Epoch 0]
Train loss: 3.9513609409332275
0.06097560975609756
Test loss: 3.8772170543670654
TEST average_precision: 0.0004060913705583756
TEST average recall: 0.02
TEST average f1: 0.0007960199004975124
[Epoch 1]
Train loss: 3.9247777462005615
0.027777777777777776
Test loss: 3.9787373542785645
TEST average_precision: 0.011148866009723686
TEST average recall: 0.04
TEST average f1: 0.014815567654769109
[Epoch 2]
Train loss: 3.815049171447754
0.013513513513513514
Test loss: 3.8559224605560303
TEST average_precision: 0.022265277857926015
TEST average recall: 0.0625
TEST average f1: 0.027788049911087312
[Epoch 3]
Train loss: 3.837283134460449
0.07870370370370369
Test loss: 4.070285797119141
TEST average_precision: 0.052741736694677875
TEST average recall: 0.075
TEST average f1: 0.0425456479566399
[Epoch 4]
Train loss: 3.657625436782837
0.0945945945945946
[Epoch 5]
Train loss: 3.4672796726226807
0.03571428571428571
Test loss: 3.6951067447662354
TEST average_precision: 0.06441302006016686
TEST average recall: 0.125
TEST average f1: 0.07853148500130602
[Epoch 6]
Train loss: 3.064021110534668
0.18596491228070175
Test loss: 3.496312141418457
TEST average_precision: 0.12894076659075973
TEST average recall: 0.1525
TEST average f1: 0.11409848899442
[Epoch 7]
Train loss: 2.8365702629089355
0.18803418803418803
Test loss: 3.439249277114868
TEST average_precision: 0.25699392181167097
TEST average recall: 0.2575
TEST average f1: 0.22023377694430327
[Epoch 8]
Train loss: 2.3942182064056396
0.27285714285714285
Test loss: 3.2906126976013184
TEST average_precision: 0.2936331128750297
TEST average recall: 0.28
TEST average f1: 0.23956024329358994
[Epoch 9]
Train loss: 1.8982263803482056
0.41623931623931626
Test loss: 2.8405799865722656
TEST average_precision: 0.4189240662718924
TEST average recall: 0.39
TEST average f1: 0.3622916752202561
[Epoch 10]
Train loss: 1.791847586631775
0.5307017543859649
Test loss: 2.926997661590576
TEST average_precision: 0.4272365280917912
TEST average recall: 0.445
TEST average f1: 0.4003126703308586
[Epoch 11]
Train loss: 1.1667183637619019
0.5666666666666667
Test loss: 2.5313408374786377
TEST average_precision: 0.5142255522255522
TEST average recall: 0.4925
TEST average f1: 0.4757401498159339
[Epoch 12]
Train loss: 1.1896055936813354
0.7027027027027027
Test loss: 2.8148062229156494
TEST average_precision: 0.5627492931904697
TEST average recall: 0.5475
TEST average f1: 0.5348920737613294
[Epoch 13]
Train loss: 0.8279592990875244
0.7587719298245613
[Epoch 14]
Train loss: 0.8933238983154297
0.7621621621621621
[Epoch 15]
Train loss: 0.5629941821098328
0.9009009009009008
[Epoch 16]
Train loss: 0.4290294349193573
0.8810810810810811
[Epoch 17]
Train loss: 0.5025902390480042
0.8647058823529411
Test loss: 3.4861950874328613
TEST average_precision: 0.5641620046620046
TEST average recall: 0.5675
TEST average f1: 0.5407998661947376
[Epoch 18]
Train loss: 0.46375665068626404
0.8518518518518519
[Epoch 19]
Train loss: 0.64968341588974
0.8310185185185185
[Epoch 20]
Train loss: 0.3240032196044922
0.903030303030303
[Epoch 21]
Train loss: 0.39277830719947815
0.8935185185185185
Test loss: 4.646547317504883
TEST average_precision: 0.6217289703760291
TEST average recall: 0.585
TEST average f1: 0.5779757183843064
[Epoch 22]
Train loss: 0.3502982258796692
0.9342105263157895
Test loss: 3.687495470046997
TEST average_precision: 0.637529008029008
TEST average recall: 0.5875
TEST average f1: 0.5909917744644492
[Epoch 23]
Train loss: 0.2509637475013733
0.9298245614035089
[Epoch 24]
Train loss: 0.09935455769300461
0.9407894736842105
Test loss: 3.812643051147461
TEST average_precision: 0.6364029859029859
TEST average recall: 0.61
TEST average f1: 0.5998918469917931
[Epoch 25]
Train loss: 0.31023555994033813
0.8354166666666666
[Epoch 26]
Train loss: 0.20426103472709656
0.9259259259259258
[Epoch 27]
Train loss: 0.5137488842010498
0.8848039215686274
[Epoch 28]
Train loss: 0.16578969359397888
0.9594594594594594
[Epoch 29]
Train loss: 0.18520544469356537
0.9594594594594594
[Epoch 30]
Train loss: 0.22972160577774048
0.9228571428571428
[Epoch 31]
Train loss: 0.10825297236442566
0.9774774774774774
[Epoch 32]
Train loss: 0.0828193873167038
0.9736842105263158
[Epoch 33]
Train loss: 0.20880283415317535
0.938095238095238
[Epoch 34]
Train loss: 0.08835342526435852
0.9932432432432432
Finished Training
training and val size: (1600, 80000) (400, 80000) (1600,)
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda'
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda' with weights_only=False
[Epoch 0]
Train loss: 3.991574764251709
0.013157894736842105
Test loss: 3.950376510620117
TEST average_precision: 0.000913295550778451
TEST average recall: 0.0225
TEST average f1: 0.0016610260542573195
[Epoch 1]
Train loss: 3.9100852012634277
0.0
Test loss: 3.909850835800171
TEST average_precision: 0.0015219688184512302
TEST average recall: 0.0375
TEST average f1: 0.002925204064634349
[Epoch 2]
Train loss: 4.00183629989624
0.0
[Epoch 3]
Train loss: 3.726649522781372
0.0876068376068376
[Epoch 4]
Train loss: 3.890739679336548
0.00980392156862745
Test loss: 3.807276725769043
TEST average_precision: 0.021231335037654075
TEST average recall: 0.055
TEST average f1: 0.026696875153643322
[Epoch 5]
Train loss: 3.8356425762176514
0.05405405405405406
[Epoch 6]
Train loss: 3.6085925102233887
0.034722222222222224
[Epoch 7]
Train loss: 3.7299644947052
0.02857142857142857
Test loss: 3.542046308517456
TEST average_precision: 0.03483427128427128
TEST average recall: 0.0725
TEST average f1: 0.0407184000210316
[Epoch 8]
Train loss: 3.3852791786193848
0.05555555555555555
Test loss: 3.3885011672973633
TEST average_precision: 0.034088220175626474
TEST average recall: 0.09
TEST average f1: 0.04238906430997546
[Epoch 9]
Train loss: 3.363107681274414
0.11538461538461539
Test loss: 3.193675994873047
TEST average_precision: 0.05756614552188772
TEST average recall: 0.1275
TEST average f1: 0.07089611228790296
[Epoch 10]
Train loss: 3.26042103767395
0.20098039215686272
Test loss: 3.0056040287017822
TEST average_precision: 0.13609164038575802
TEST average recall: 0.165
TEST average f1: 0.11162811158569673
[Epoch 11]
Train loss: 2.850975751876831
0.20833333333333331
Test loss: 3.005066394805908
TEST average_precision: 0.2070908949089727
TEST average recall: 0.2125
TEST average f1: 0.16721799482460373
[Epoch 12]
Train loss: 2.927766799926758
0.1884259259259259
Test loss: 2.6360158920288086
TEST average_precision: 0.2232101928572517
TEST average recall: 0.2525
TEST average f1: 0.19810586119454487
[Epoch 13]
Train loss: 2.5248799324035645
0.20833333333333331
Test loss: 2.849851608276367
TEST average_precision: 0.2837160360812811
TEST average recall: 0.2825
TEST average f1: 0.24764205531244068
[Epoch 14]
Train loss: 2.5368921756744385
0.344017094017094
[Epoch 15]
Train loss: 2.387679100036621
0.22619047619047616
Test loss: 2.390090227127075
TEST average_precision: 0.3515310849281438
TEST average recall: 0.3475
TEST average f1: 0.3215799221590243
[Epoch 16]
Train loss: 1.8093478679656982
0.4978632478632478
Test loss: 2.7853891849517822
TEST average_precision: 0.3727261072261073
TEST average recall: 0.3525
TEST average f1: 0.32452562879863156
[Epoch 17]
Train loss: 1.3979250192642212
0.5846153846153845
[Epoch 18]
Train loss: 1.6892873048782349
0.47058823529411764
[Epoch 19]
Train loss: 1.5754637718200684
0.46271929824561403
Test loss: 2.8333301544189453
TEST average_precision: 0.4032704517704518
TEST average recall: 0.4
TEST average f1: 0.36497254791991635
[Epoch 20]
Train loss: 1.581997275352478
0.6464912280701753
[Epoch 21]
Train loss: 1.1297811269760132
0.626068376068376
[Epoch 22]
Train loss: 0.970470130443573
0.787037037037037
[Epoch 23]
Train loss: 1.0130256414413452
0.6764705882352942
[Epoch 24]
Train loss: 0.9834879636764526
0.6713675213675214
Test loss: 2.617774486541748
TEST average_precision: 0.3881263088763089
TEST average recall: 0.41
TEST average f1: 0.37800629092269955
[Epoch 25]
Train loss: 0.9520602226257324
0.65625
[Epoch 26]
Train loss: 0.8540453910827637
0.7451612903225807
[Epoch 27]
Train loss: 0.7818596363067627
0.7984848484848486
Test loss: 2.4167301654815674
TEST average_precision: 0.45945535020535017
TEST average recall: 0.4425
TEST average f1: 0.4242427696366988
[Epoch 28]
Train loss: 0.4735381603240967
0.861904761904762
[Epoch 29]
Train loss: 0.6108177900314331
0.8229166666666667
[Epoch 30]
Train loss: 0.5506770610809326
0.8265765765765766
[Epoch 31]
Train loss: 0.2844955027103424
0.8729729729729729
[Epoch 32]
Train loss: 0.5942408442497253
0.8354166666666666
[Epoch 33]
Train loss: 0.3741135597229004
0.9071428571428571
[Epoch 34]
Train loss: 0.5485830903053284
0.8
[Epoch 35]
Train loss: 0.251936137676239
0.8949074074074075
[Epoch 36]
Train loss: 0.2820797264575958
0.9145299145299145
[Epoch 37]
Train loss: 0.5693204998970032
0.8119047619047618
Finished Training
training and val size: (1600, 80000) (400, 80000) (1600,)
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda'
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda' with weights_only=False
[Epoch 0]
Train loss: 4.017040729522705
0.0
Test loss: 3.9095141887664795
TEST average_precision: 0.000449438202247191
TEST average recall: 0.02
TEST average f1: 0.0008791208791208792
[Epoch 1]
Train loss: 3.9043643474578857
0.0125
Test loss: 3.874497890472412
TEST average_precision: 0.005251927437641723
TEST average recall: 0.035
TEST average f1: 0.007382162487764476
[Epoch 2]
Train loss: 3.7735331058502197
0.0
Test loss: 4.000589847564697
TEST average_precision: 0.004696950521010803
TEST average recall: 0.04
TEST average f1: 0.007837859110586383
[Epoch 3]
Train loss: 3.7295284271240234
0.05263157894736842
Test loss: 4.068474292755127
TEST average_precision: 0.014479303641283216
TEST average recall: 0.045
TEST average f1: 0.011322215872874665
[Epoch 4]
Train loss: 3.724426031112671
0.0763888888888889
Test loss: 4.034200668334961
TEST average_precision: 0.026569067029879698
TEST average recall: 0.0475
TEST average f1: 0.015131006392660526
[Epoch 5]
Train loss: 3.758061647415161
0.057870370370370364
[Epoch 6]
Train loss: 3.6319501399993896
0.03809523809523809
[Epoch 7]
Train loss: 3.6910767555236816
0.05092592592592592
Test loss: 4.123342990875244
TEST average_precision: 0.018813388356413843
TEST average recall: 0.0525
TEST average f1: 0.01838184838153367
[Epoch 8]
Train loss: 3.7421276569366455
0.02525252525252525
[Epoch 9]
Train loss: 3.6254799365997314
0.036585365853658534
[Epoch 10]
Train loss: 3.8945295810699463
0.0
[Epoch 11]
Train loss: 3.5730762481689453
0.04504504504504504
[Epoch 12]
Train loss: 3.614698886871338
0.06306306306306306
[Epoch 13]
Train loss: 3.3980488777160645
0.09009009009009009
Test loss: 3.9825966358184814
TEST average_precision: 0.021364260618608442
TEST average recall: 0.0625
TEST average f1: 0.026759940259025825
[Epoch 14]
Train loss: 3.320659875869751
0.05921052631578947
Test loss: 3.9973723888397217
TEST average_precision: 0.02641110419934729
TEST average recall: 0.065
TEST average f1: 0.029596922944871693
[Epoch 15]
Train loss: 3.4733152389526367
0.033854166666666664
[Epoch 16]
Train loss: 3.2817513942718506
0.041666666666666664
Test loss: 3.7112009525299072
TEST average_precision: 0.05176166069114107
TEST average recall: 0.0775
TEST average f1: 0.042329436844711674
[Epoch 17]
Train loss: 2.8619792461395264
0.1752136752136752
Test loss: 3.4597647190093994
TEST average_precision: 0.0893298345798346
TEST average recall: 0.1375
TEST average f1: 0.10091173154331048
[Epoch 18]
Train loss: 3.191884756088257
0.12037037037037039
Test loss: 3.531531572341919
TEST average_precision: 0.12260009463153479
TEST average recall: 0.1525
TEST average f1: 0.11599110444220712
[Epoch 19]
Train loss: 2.9613494873046875
0.22857142857142854
Test loss: 3.761117458343506
TEST average_precision: 0.16394294827419365
TEST average recall: 0.1825
TEST average f1: 0.1338873850601237
[Epoch 20]
Train loss: 2.6041769981384277
0.18859649122807015
[Epoch 21]
Train loss: 2.3024709224700928
0.35135135135135137
Test loss: 2.976473808288574
TEST average_precision: 0.21092732336338474
TEST average recall: 0.2625
TEST average f1: 0.21958296425269858
[Epoch 22]
Train loss: 2.15285062789917
0.3611111111111111
Test loss: 3.056399345397949
TEST average_precision: 0.2974395662054701
TEST average recall: 0.3125
TEST average f1: 0.28365117638281434
[Epoch 23]
Train loss: 2.1179141998291016
0.45720720720720714
[Epoch 24]
Train loss: 2.506930351257324
0.30375
[Epoch 25]
Train loss: 1.896246314048767
0.4232456140350877
Test loss: 2.752254009246826
TEST average_precision: 0.3462326587705148
TEST average recall: 0.3375
TEST average f1: 0.3119251114455349
[Epoch 26]
Train loss: 1.7479965686798096
0.4094444444444444
[Epoch 27]
Train loss: 1.743404507637024
0.45833333333333326
Test loss: 3.2036828994750977
TEST average_precision: 0.3800021148442201
TEST average recall: 0.3525
TEST average f1: 0.3264530402518019
[Epoch 28]
Train loss: 1.2305101156234741
0.6284313725490196
Test loss: 2.8829851150512695
TEST average_precision: 0.34582708567363296
TEST average recall: 0.36
TEST average f1: 0.3277997621477558
[Epoch 29]
Train loss: 1.4894318580627441
0.5733333333333333
[Epoch 30]
Train loss: 1.3928897380828857
0.600462962962963
Test loss: 2.733186721801758
TEST average_precision: 0.44508235331919543
TEST average recall: 0.395
TEST average f1: 0.3780190172744352
[Epoch 31]
Train loss: 0.8149345517158508
0.7412280701754386
[Epoch 32]
Train loss: 1.254742980003357
0.5964912280701755
[Epoch 33]
Train loss: 0.7627511620521545
0.7407407407407407
[Epoch 34]
Train loss: 0.5808944702148438
0.8314814814814814
[Epoch 35]
Train loss: 0.8243507146835327
0.7928571428571428
Test loss: 3.5938315391540527
TEST average_precision: 0.4677735714577819
TEST average recall: 0.425
TEST average f1: 0.41087813148797125
[Epoch 36]
Train loss: 0.8050035834312439
0.7324561403508771
[Epoch 37]
Train loss: 0.5836989283561707
0.824074074074074
[Epoch 38]
Train loss: 0.6747514009475708
0.8311965811965811
Test loss: 3.8664770126342773
TEST average_precision: 0.48340800865800865
TEST average recall: 0.445
TEST average f1: 0.44236877259905255
[Epoch 39]
Train loss: 0.5518029928207397
0.846078431372549
[Epoch 40]
Train loss: 0.42486128211021423
0.8596491228070174
[Epoch 41]
Train loss: 0.42078569531440735
0.8717948717948718
Test loss: 4.678016662597656
TEST average_precision: 0.48326168344898995
TEST average recall: 0.45
TEST average f1: 0.4349748225047862
[Epoch 42]
Train loss: 0.3887925148010254
0.8771929824561402
[Epoch 43]
Train loss: 0.37728583812713623
0.8935185185185185
[Epoch 44]
Train loss: 0.4146728813648224
0.8842592592592592
[Epoch 45]
Train loss: 0.3158663213253021
0.9102564102564102
[Epoch 46]
Train loss: 0.35809049010276794
0.8823529411764706
[Epoch 47]
Train loss: 0.22588078677654266
0.9346846846846846
[Epoch 48]
Train loss: 0.31903839111328125
0.8666666666666666
[Epoch 49]
Train loss: 0.40349724888801575
0.8974358974358975
[Epoch 50]
Train loss: 0.25576984882354736
0.9412280701754385
[Epoch 51]
Train loss: 0.23848149180412292
0.9294871794871795
Finished Training
training and val size: (1600, 80000) (400, 80000) (1600,)
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda'
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda' with weights_only=False
[Epoch 0]
Train loss: 3.8693761825561523
0.013513513513513514
Test loss: 4.006702899932861
TEST average_precision: 0.003744644387317909
TEST average recall: 0.0225
TEST average f1: 0.0036631881971932343
[Epoch 1]
Train loss: 3.8670663833618164
0.0
Test loss: 3.7923357486724854
TEST average_precision: 0.011807491289198606
TEST average recall: 0.0275
TEST average f1: 0.009418079096045197
[Epoch 2]
Train loss: 3.8166866302490234
0.0
Test loss: 3.8827362060546875
TEST average_precision: 0.012741800894919622
TEST average recall: 0.0525
TEST average f1: 0.018557485766989935
[Epoch 3]
Train loss: 3.7232344150543213
0.0641025641025641
Test loss: 3.8520090579986572
TEST average_precision: 0.026348151785704824
TEST average recall: 0.055
TEST average f1: 0.025710965363139274
[Epoch 4]
Train loss: 3.785181999206543
0.07207207207207207
Test loss: 3.576693058013916
TEST average_precision: 0.070545003217499
TEST average recall: 0.065
TEST average f1: 0.03991062137460531
[Epoch 5]
Train loss: 3.607225179672241
0.08974358974358974
Test loss: 3.3747034072875977
TEST average_precision: 0.07222350416951176
TEST average recall: 0.1025
TEST average f1: 0.06713401068401068
[Epoch 6]
Train loss: 3.2698025703430176
0.2252252252252252
Test loss: 3.057539463043213
TEST average_precision: 0.14124185166042166
TEST average recall: 0.1575
TEST average f1: 0.1128694713605804
[Epoch 7]
Train loss: 2.821709632873535
0.1864864864864865
Test loss: 2.8163652420043945
TEST average_precision: 0.2473146951148529
TEST average recall: 0.2275
TEST average f1: 0.2030530578296109
[Epoch 8]
Train loss: 2.674161911010742
0.3076923076923077
Test loss: 2.8386757373809814
TEST average_precision: 0.29023533655886596
TEST average recall: 0.28
TEST average f1: 0.2572935379859875
[Epoch 9]
Train loss: 2.374117136001587
0.3925438596491228
Test loss: 2.073178768157959
TEST average_precision: 0.2518067784468713
TEST average recall: 0.285
TEST average f1: 0.24255533227136403
[Epoch 10]
Train loss: 2.3654534816741943
0.3288288288288288
Test loss: 2.51881742477417
TEST average_precision: 0.315592102256189
TEST average recall: 0.2975
TEST average f1: 0.2479658813889044
[Epoch 11]
Train loss: 1.9458972215652466
0.36622807017543857
Test loss: 2.296480894088745
TEST average_precision: 0.327804834054834
TEST average recall: 0.3275
TEST average f1: 0.2997879711036933
[Epoch 12]
Train loss: 1.9190623760223389
0.45299145299145294
Test loss: 2.6949381828308105
TEST average_precision: 0.38032393913276263
TEST average recall: 0.3675
TEST average f1: 0.340968509818355
[Epoch 13]
Train loss: 1.4847538471221924
0.4708333333333333
[Epoch 14]
Train loss: 1.3299225568771362
0.625
[Epoch 15]
Train loss: 1.352954626083374
0.5675675675675675
[Epoch 16]
Train loss: 1.2698047161102295
0.6851851851851851
Test loss: 2.8685061931610107
TEST average_precision: 0.4266133807712755
TEST average recall: 0.4175
TEST average f1: 0.38826219122705863
[Epoch 17]
Train loss: 0.7472112774848938
0.8270833333333332
[Epoch 18]
Train loss: 1.0779900550842285
0.6776315789473685
[Epoch 19]
Train loss: 0.9354117512702942
0.6777777777777777
[Epoch 20]
Train loss: 0.9295756816864014
0.7105263157894737
[Epoch 21]
Train loss: 0.7886495590209961
0.7214285714285714
Test loss: 2.9850552082061768
TEST average_precision: 0.4380537338478515
TEST average recall: 0.435
TEST average f1: 0.41379315493587937
[Epoch 22]
Train loss: 0.6489226818084717
0.7651515151515151
[Epoch 23]
Train loss: 0.8209109902381897
0.8009259259259259
[Epoch 24]
Train loss: 0.5440126657485962
0.8041666666666668
Test loss: 3.409404754638672
TEST average_precision: 0.47810508935508933
TEST average recall: 0.445
TEST average f1: 0.4201881261153707
[Epoch 25]
Train loss: 0.5870597958564758
0.7412280701754386
[Epoch 26]
Train loss: 0.43310633301734924
0.8725490196078431
[Epoch 27]
Train loss: 0.44957712292671204
0.8504273504273504
[Epoch 28]
Train loss: 0.6210486888885498
0.85
[Epoch 29]
Train loss: 0.5267966985702515
0.7549019607843137
[Epoch 30]
Train loss: 0.4043067395687103
0.8852941176470589
[Epoch 31]
Train loss: 0.617858350276947
0.7882882882882883
[Epoch 32]
Train loss: 0.42078059911727905
0.8376068376068377
[Epoch 33]
Train loss: 0.15137848258018494
0.9504504504504504
[Epoch 34]
Train loss: 0.17886888980865479
0.9444444444444444
Finished Training
training and val size: (1600, 80000) (400, 80000) (1600,)
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda'
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda' with weights_only=False
[Epoch 0]
Train loss: 3.8826699256896973
0.038461538461538464
Test loss: 4.158257961273193
TEST average_precision: 0.00040302267002518893
TEST average recall: 0.02
TEST average f1: 0.0007901234567901234
[Epoch 1]
Train loss: 3.888580322265625
0.0
Test loss: 3.7370450496673584
TEST average_precision: 0.008743729523501534
TEST average recall: 0.0475
TEST average f1: 0.012288977675547548
[Epoch 2]
Train loss: 3.8066062927246094
0.008333333333333333
Test loss: 3.8558146953582764
TEST average_precision: 0.021310303752233476
TEST average recall: 0.05
TEST average f1: 0.019033426385766175
[Epoch 3]
Train loss: 3.6405537128448486
0.044715447154471545
Test loss: 3.703594923019409
TEST average_precision: 0.032721557484972005
TEST average recall: 0.0625
TEST average f1: 0.03322041421171856
[Epoch 4]
Train loss: 3.467503070831299
0.08095238095238094
Test loss: 3.599100112915039
TEST average_precision: 0.09215292618567802
TEST average recall: 0.12
TEST average f1: 0.07965289263947312
[Epoch 5]
Train loss: 3.1206743717193604
0.20714285714285716
Test loss: 3.166017532348633
TEST average_precision: 0.21724320940497407
TEST average recall: 0.235
TEST average f1: 0.17106021379484068
[Epoch 6]
Train loss: 2.565868854522705
0.2595238095238095
Test loss: 3.025599718093872
TEST average_precision: 0.22173023175654752
TEST average recall: 0.2525
TEST average f1: 0.2071238284556363
[Epoch 7]
Train loss: 2.3854682445526123
0.3803418803418804
Test loss: 3.021531581878662
TEST average_precision: 0.3062871647329852
TEST average recall: 0.3325
TEST average f1: 0.28628203101157274
[Epoch 8]
Train loss: 2.336418390274048
0.3013888888888889
Test loss: 3.1210429668426514
TEST average_precision: 0.343539227680532
TEST average recall: 0.34
TEST average f1: 0.3044187358914746
[Epoch 9]
Train loss: 1.6117069721221924
0.5657894736842104
Test loss: 3.0283613204956055
TEST average_precision: 0.38545266878467854
TEST average recall: 0.3775
TEST average f1: 0.34814636517252656
[Epoch 10]
Train loss: 2.1257619857788086
0.5131578947368421
[Epoch 11]
Train loss: 1.5633525848388672
0.47368421052631576
Test loss: 2.440541982650757
TEST average_precision: 0.4468751044277359
TEST average recall: 0.44
TEST average f1: 0.41226218675707166
[Epoch 12]
Train loss: 1.7923543453216553
0.4359649122807017
[Epoch 13]
Train loss: 1.3304270505905151
0.44871794871794873
[Epoch 14]
Train loss: 1.0837091207504272
0.6612612612612613
Test loss: 2.679783344268799
TEST average_precision: 0.5174815119521002
TEST average recall: 0.48
TEST average f1: 0.4539809260203516
[Epoch 15]
Train loss: 1.0381784439086914
0.6293859649122806
[Epoch 16]
Train loss: 1.0499653816223145
0.6463963963963963
[Epoch 17]
Train loss: 0.7535101175308228
0.8156565656565656
[Epoch 18]
Train loss: 0.8562875390052795
0.7238095238095238
[Epoch 19]
Train loss: 0.9343329071998596
0.7837837837837838
[Epoch 20]
Train loss: 0.7172775268554688
0.7351851851851853
[Epoch 21]
Train loss: 0.7549267411231995
0.7371794871794872
Test loss: 3.081064224243164
TEST average_precision: 0.5311108891108891
TEST average recall: 0.4875
TEST average f1: 0.48208068153037187
[Epoch 22]
Train loss: 0.6110624670982361
0.823170731707317
[Epoch 23]
Train loss: 0.6536363363265991
0.803030303030303
[Epoch 24]
Train loss: 0.5639636516571045
0.819047619047619
[Epoch 25]
Train loss: 0.4279831647872925
0.8986486486486487
[Epoch 26]
Train loss: 0.5393122434616089
0.8287037037037037
[Epoch 27]
Train loss: 0.34412670135498047
0.8918918918918919
[Epoch 28]
Train loss: 0.3996076285839081
0.8859649122807017
[Epoch 29]
Train loss: 0.3463428020477295
0.9324074074074074
Test loss: 4.30869722366333
TEST average_precision: 0.48898913504795866
TEST average recall: 0.4925
TEST average f1: 0.4686419675208207
[Epoch 30]
Train loss: 0.3160536587238312
0.8813725490196078
[Epoch 31]
Train loss: 0.22826305031776428
0.9391891891891891
[Epoch 32]
Train loss: 0.14474889636039734
0.9786324786324786
[Epoch 33]
Train loss: 0.2759558856487274
0.9050925925925924
[Epoch 34]
Train loss: 0.2503911852836609
0.9236111111111112
[Epoch 35]
Train loss: 0.2776988744735718
0.8774509803921569
[Epoch 36]
Train loss: 0.09707590192556381
0.9342105263157895
[Epoch 37]
Train loss: 0.2403857707977295
0.9465811965811965
[Epoch 38]
Train loss: 0.17533889412879944
0.9517543859649122
[Epoch 39]
Train loss: 0.34966742992401123
0.9197278911564626
Finished Training
training and val size: (1600, 80000) (400, 80000) (1600,)
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda'
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda' with weights_only=False
[Epoch 0]
Train loss: 3.978210210800171
0.036585365853658534
Test loss: 3.85233211517334
TEST average_precision: 0.007091069849690539
TEST average recall: 0.0275
TEST average f1: 0.007889992360580597
[Epoch 1]
Train loss: 3.76285457611084
0.041666666666666664
Test loss: 4.00575065612793
TEST average_precision: 0.013355979966282319
TEST average recall: 0.0375
TEST average f1: 0.011900452488687784
[Epoch 2]
Train loss: 3.826997756958008
0.0
Test loss: 3.8718175888061523
TEST average_precision: 0.028497771957135917
TEST average recall: 0.05
TEST average f1: 0.0250352432291454
[Epoch 3]
Train loss: 3.789332866668701
0.041666666666666664
Test loss: 3.8142237663269043
TEST average_precision: 0.014574894504067308
TEST average recall: 0.0525
TEST average f1: 0.01758161551994331
[Epoch 4]
Train loss: 3.739861011505127
0.02702702702702703
Test loss: 3.6742300987243652
TEST average_precision: 0.023231233421750663
TEST average recall: 0.0625
TEST average f1: 0.026680240375892547
[Epoch 5]
Train loss: 3.3820841312408447
0.1238095238095238
Test loss: 3.5651257038116455
TEST average_precision: 0.0769862981024843
TEST average recall: 0.115
TEST average f1: 0.07718828501097408
[Epoch 6]
Train loss: 3.1876494884490967
0.08771929824561404
Test loss: 3.394493579864502
TEST average_precision: 0.14197101317316754
TEST average recall: 0.1525
TEST average f1: 0.108173015030347
[Epoch 7]
Train loss: 2.9643032550811768
0.17094017094017092
Test loss: 3.3763928413391113
TEST average_precision: 0.22039699251856384
TEST average recall: 0.1975
TEST average f1: 0.1488599565600736
[Epoch 8]
Train loss: 2.640533924102783
0.23380952380952383
Test loss: 3.309718608856201
TEST average_precision: 0.20240535212233957
TEST average recall: 0.2225
TEST average f1: 0.18419314145921206
[Epoch 9]
Train loss: 1.9761123657226562
0.364957264957265
Test loss: 3.1856765747070312
TEST average_precision: 0.24116737596021487
TEST average recall: 0.2525
TEST average f1: 0.20931290560007432
[Epoch 10]
Train loss: 2.3818323612213135
0.3464912280701754
Test loss: 3.8283610343933105
TEST average_precision: 0.265064770523594
TEST average recall: 0.255
TEST average f1: 0.22555117814347028
[Epoch 11]
Train loss: 2.0155394077301025
0.4309523809523809
Test loss: 3.6191916465759277
TEST average_precision: 0.366959681239093
TEST average recall: 0.305
TEST average f1: 0.291855925797067
[Epoch 12]
Train loss: 2.226348638534546
0.34009009009009006
Test loss: 3.059171438217163
TEST average_precision: 0.33012578678631305
TEST average recall: 0.33
TEST average f1: 0.295183496336949
[Epoch 13]
Train loss: 1.6307497024536133
0.5087719298245613
Test loss: 3.7154457569122314
TEST average_precision: 0.3659846349302871
TEST average recall: 0.335
TEST average f1: 0.3126701900333429
[Epoch 14]
Train loss: 1.4210370779037476
0.5585585585585585
[Epoch 15]
Train loss: 1.6769860982894897
0.4527027027027027
[Epoch 16]
Train loss: 1.2743092775344849
0.5747747747747748
Test loss: 4.038686275482178
TEST average_precision: 0.3890442408755102
TEST average recall: 0.3425
TEST average f1: 0.3229500603428319
[Epoch 17]
Train loss: 1.1559265851974487
0.6323529411764706
[Epoch 18]
Train loss: 1.1320631504058838
0.6388888888888888
Test loss: 4.2459492683410645
TEST average_precision: 0.3972491368784472
TEST average recall: 0.3675
TEST average f1: 0.3492039524245406
[Epoch 19]
Train loss: 1.0597994327545166
0.6921296296296295
Test loss: 4.070160865783691
TEST average_precision: 0.3969499944499944
TEST average recall: 0.3825
TEST average f1: 0.36928549513441666
[Epoch 20]
Train loss: 0.7923868894577026
0.7237373737373737
Test loss: 3.996083974838257
TEST average_precision: 0.4061769341769342
TEST average recall: 0.3875
TEST average f1: 0.3689944931080346
[Epoch 21]
Train loss: 1.0532441139221191
0.7314814814814814
[Epoch 22]
Train loss: 0.6616377234458923
0.8662280701754386
[Epoch 23]
Train loss: 0.7269594669342041
0.7280701754385964
Test loss: 3.9437367916107178
TEST average_precision: 0.4377999461838471
TEST average recall: 0.395
TEST average f1: 0.3809861758229506
[Epoch 24]
Train loss: 0.6946101784706116
0.7587719298245613
[Epoch 25]
Train loss: 0.7022446393966675
0.7958333333333333
Test loss: 5.461618900299072
TEST average_precision: 0.3992472420939913
TEST average recall: 0.4
TEST average f1: 0.3775206086540452
[Epoch 26]
Train loss: 0.5331318378448486
0.8310185185185185
Test loss: 5.301297187805176
TEST average_precision: 0.4499182192076929
TEST average recall: 0.415
TEST average f1: 0.4100521294387898
[Epoch 27]
Train loss: 0.37312963604927063
0.8823529411764706
[Epoch 28]
Train loss: 0.5047573447227478
0.8198198198198198
Test loss: 5.507680416107178
TEST average_precision: 0.42858247308247305
TEST average recall: 0.4175
TEST average f1: 0.4039178199291014
[Epoch 29]
Train loss: 0.37129780650138855
0.8400900900900901
Test loss: 5.03648567199707
TEST average_precision: 0.45440484953642846
TEST average recall: 0.43
TEST average f1: 0.4164100045694472
[Epoch 30]
Train loss: 0.33066293597221375
0.8714285714285713
[Epoch 31]
Train loss: 0.40205106139183044
0.8783783783783784
Test loss: 5.264767169952393
TEST average_precision: 0.43185403485403484
TEST average recall: 0.4375
TEST average f1: 0.41450727776882035
[Epoch 32]
Train loss: 0.4400124251842499
0.8771929824561402
[Epoch 33]
Train loss: 0.4130004942417145
0.8642857142857143
[Epoch 34]
Train loss: 0.2387595772743225
0.9617117117117115
Test loss: 5.1781463623046875
TEST average_precision: 0.4672537462537462
TEST average recall: 0.445
TEST average f1: 0.4275900515417483
[Epoch 35]
Train loss: 0.362030953168869
0.9259259259259258
[Epoch 36]
Train loss: 0.10892356187105179
0.9786324786324786
[Epoch 37]
Train loss: 0.1735875904560089
0.91869918699187
[Epoch 38]
Train loss: 0.28373974561691284
0.9294871794871795
[Epoch 39]
Train loss: 0.6551689505577087
0.936936936936937
[Epoch 40]
Train loss: 0.2817237079143524
0.9537037037037036
[Epoch 41]
Train loss: 0.5119962692260742
0.8700980392156863
[Epoch 42]
Train loss: 0.4687011241912842
0.8873873873873872
[Epoch 43]
Train loss: 0.40907809138298035
0.8873873873873872
[Epoch 44]
Train loss: 0.1273730844259262
0.93125
Finished Training
training and val size: (1600, 80000) (400, 80000) (1600,)
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda'
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda' with weights_only=False
[Epoch 0]
Train loss: 1.6575957536697388
0.5701754385964912
Test loss: 1.0709584951400757
TEST average_precision: 0.8012944930886107
TEST average recall: 0.7775
TEST average f1: 0.7533866926704859
[Epoch 1]
Train loss: 0.48540249466896057
0.8596491228070177
Test loss: 0.3969433307647705
TEST average_precision: 0.8987467532467532
TEST average recall: 0.8725
TEST average f1: 0.8585031532309092
[Epoch 2]
Train loss: 0.19755125045776367
0.9391891891891891
Test loss: 0.10984932631254196
TEST average_precision: 0.9402575757575758
TEST average recall: 0.9325
TEST average f1: 0.929245332410967
[Epoch 3]
Train loss: 0.16041167080402374
0.9358974358974359
[Epoch 4]
Train loss: 0.09695056080818176
0.9926470588235294
[Epoch 5]
Train loss: 0.06009737774729729
0.990990990990991
[Epoch 6]
Train loss: 0.07224702090024948
0.9722222222222222
[Epoch 7]
Train loss: 0.09861065447330475
0.9799999999999999
[Epoch 8]
Train loss: 0.0275329127907753
0.9861111111111112
[Epoch 9]
Train loss: 0.02752871811389923
0.9871794871794872
[Epoch 10]
Train loss: 0.013829806819558144
1.0
[Epoch 11]
Train loss: 0.015748485922813416
0.9736842105263158
[Epoch 12]
Train loss: 0.01999368518590927
0.9722222222222222
Finished Training
training and val size: (1600, 80000) (400, 80000) (1600,)
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda'
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda' with weights_only=False
[Epoch 0]
Train loss: 1.475000262260437
0.6018518518518517
Test loss: 1.0492563247680664
TEST average_precision: 0.758075786786313
TEST average recall: 0.7525
TEST average f1: 0.7273710358397558
[Epoch 1]
Train loss: 0.5338237285614014
0.8916666666666666
Test loss: 0.4434545040130615
TEST average_precision: 0.8709822954822956
TEST average recall: 0.8375
TEST average f1: 0.8278673623903802
[Epoch 2]
Train loss: 0.299446165561676
0.9212962962962963
Test loss: 0.3203188478946686
TEST average_precision: 0.8932319347319347
TEST average recall: 0.8725
TEST average f1: 0.8701813375822663
[Epoch 3]
Train loss: 0.18170678615570068
0.9605263157894737
Test loss: 0.21005672216415405
TEST average_precision: 0.9176944166944166
TEST average recall: 0.8875
TEST average f1: 0.8871243416400234
[Epoch 4]
Train loss: 0.17674441635608673
0.9671296296296296
Test loss: 0.5242493152618408
TEST average_precision: 0.9221724386724387
TEST average recall: 0.895
TEST average f1: 0.8964024632058687
[Epoch 5]
Train loss: 0.10760638117790222
0.9722222222222222
Test loss: 0.26729467511177063
TEST average_precision: 0.9325115440115439
TEST average recall: 0.9125
TEST average f1: 0.9087591803135617
[Epoch 6]
Train loss: 0.07832996547222137
0.9857142857142858
[Epoch 7]
Train loss: 0.07619807124137878
0.9722222222222222
[Epoch 8]
Train loss: 0.03089323826134205
1.0
Test loss: 0.038911931216716766
TEST average_precision: 0.9424025974025975
TEST average recall: 0.9325
TEST average f1: 0.9335752348786405
[Epoch 9]
Train loss: 0.06546229869127274
0.9796747967479674
[Epoch 10]
Train loss: 0.05262456834316254
0.9868421052631579
[Epoch 11]
Train loss: 0.005279662553220987
1.0
[Epoch 12]
Train loss: 0.033451683819293976
0.990990990990991
[Epoch 13]
Train loss: 0.10965787619352341
0.990990990990991
[Epoch 14]
Train loss: 0.00632360577583313
1.0
[Epoch 15]
Train loss: 0.010497980751097202
1.0
[Epoch 16]
Train loss: 0.057656701654195786
1.0
[Epoch 17]
Train loss: 0.26481759548187256
0.9615384615384616
[Epoch 18]
Train loss: 0.08755788207054138
0.9837962962962963
Finished Training
training and val size: (1600, 80000) (400, 80000) (1600,)
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda'
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda' with weights_only=False
[Epoch 0]
Train loss: 1.625927448272705
0.6576576576576576
Test loss: 0.8890547752380371
TEST average_precision: 0.8270849488675575
TEST average recall: 0.8
TEST average f1: 0.787414143918041
[Epoch 1]
Train loss: 0.6282164454460144
0.8201754385964912
Test loss: 0.029504697769880295
TEST average_precision: 0.8800393495393496
TEST average recall: 0.85
TEST average f1: 0.8422854952065478
[Epoch 2]
Train loss: 0.16595548391342163
0.9785714285714285
Test loss: 0.009722667746245861
TEST average_precision: 0.9190876345876348
TEST average recall: 0.9025
TEST average f1: 0.9035521514948759
[Epoch 3]
Train loss: 0.2277487814426422
0.9252136752136753
[Epoch 4]
Train loss: 0.12749725580215454
0.9662162162162162
Test loss: 0.0037003071047365665
TEST average_precision: 0.9288434343434343
TEST average recall: 0.91
TEST average f1: 0.9080674858337398
[Epoch 5]
Train loss: 0.07496919482946396
0.9935897435897436
[Epoch 6]
Train loss: 0.039334625005722046
0.9864864864864865
Test loss: 0.004007756244391203
TEST average_precision: 0.9231702741702739
TEST average recall: 0.915
TEST average f1: 0.914042251178474
[Epoch 7]
Train loss: 0.1624441295862198
0.9594594594594594
Test loss: 0.0077055953443050385
TEST average_precision: 0.9279877344877344
TEST average recall: 0.9175
TEST average f1: 0.9167443627923504
[Epoch 8]
Train loss: 0.023735759779810905
1.0
[Epoch 9]
Train loss: 0.07058612257242203
0.9868421052631579
[Epoch 10]
Train loss: 0.12499519437551498
0.9797297297297297
[Epoch 11]
Train loss: 0.07523909956216812
0.9912280701754386
[Epoch 12]
Train loss: 0.0066839964129030704
1.0
[Epoch 13]
Train loss: 0.012764467857778072
1.0
[Epoch 14]
Train loss: 0.0032714575063437223
1.0
[Epoch 15]
Train loss: 0.09478968381881714
0.972972972972973
[Epoch 16]
Train loss: 0.14327657222747803
0.9351851851851851
[Epoch 17]
Train loss: 0.1003279909491539
0.9916666666666666
Finished Training
training and val size: (1600, 80000) (400, 80000) (1600,)
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda'
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda' with weights_only=False
[Epoch 0]
Train loss: 1.5423166751861572
0.7521367521367522
Test loss: 0.5042223930358887
TEST average_precision: 0.8322485584590847
TEST average recall: 0.785
TEST average f1: 0.7593096486130542
[Epoch 1]
Train loss: 0.6786486506462097
0.7928571428571428
Test loss: 0.054477348923683167
TEST average_precision: 0.9274242424242424
TEST average recall: 0.9125
TEST average f1: 0.909522267893785
[Epoch 2]
Train loss: 0.3651743531227112
0.9208333333333332
Test loss: 0.3142274022102356
TEST average_precision: 0.9464257964257965
TEST average recall: 0.9275
TEST average f1: 0.9216511677550848
[Epoch 3]
Train loss: 0.21020956337451935
0.9599303135888503
Test loss: 0.06667125970125198
TEST average_precision: 0.9419841269841269
TEST average recall: 0.93
TEST average f1: 0.9231493930905694
[Epoch 4]
Train loss: 0.13095372915267944
0.9571428571428572
Test loss: 0.11290917545557022
TEST average_precision: 0.9498888888888889
TEST average recall: 0.9425
TEST average f1: 0.9424136321195146
[Epoch 5]
Train loss: 0.03331290930509567
0.9714285714285714
[Epoch 6]
Train loss: 0.1333538442850113
0.9571428571428572
[Epoch 7]
Train loss: 0.09556012600660324
0.985042735042735
[Epoch 8]
Train loss: 0.03393937647342682
0.9930555555555556
[Epoch 9]
Train loss: 0.05636199936270714
0.9868421052631579
Test loss: 1.171842336654663
TEST average_precision: 0.9542907647907648
TEST average recall: 0.9475
TEST average f1: 0.9474757992265733
[Epoch 10]
Train loss: 0.22568808495998383
0.9671052631578947
Test loss: 0.9132127165794373
TEST average_precision: 0.9593333333333334
TEST average recall: 0.955
TEST average f1: 0.954397328162034
[Epoch 11]
Train loss: 0.015387912280857563
1.0
[Epoch 12]
Train loss: 0.04529085382819176
0.9912280701754386
[Epoch 13]
Train loss: 0.016645332798361778
1.0
[Epoch 14]
Train loss: 0.009512271732091904
1.0
[Epoch 15]
Train loss: 0.059809498488903046
0.9736842105263158
[Epoch 16]
Train loss: 0.014338110573589802
1.0
[Epoch 17]
Train loss: 0.07097258418798447
0.9898989898989898
[Epoch 18]
Train loss: 0.01134621724486351
1.0
[Epoch 19]
Train loss: 0.11857735365629196
0.9639639639639641
[Epoch 20]
Train loss: 0.16867348551750183
0.9861111111111112
Finished Training
training and val size: (1600, 80000) (400, 80000) (1600,)
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda'
Loading checkpoint './Cnn14_16k_mAP=0.438.pth' to map_location='cuda' with weights_only=False
[Epoch 0]
Train loss: 1.5550920963287354
0.6056910569105691
Test loss: 1.9121676683425903
TEST average_precision: 0.7739287934287935
TEST average recall: 0.7525
TEST average f1: 0.7381450529174987
[Epoch 1]
Train loss: 0.48313599824905396
0.8379629629629629
Test loss: 0.5372491478919983
TEST average_precision: 0.9060353535353535
TEST average recall: 0.8875
TEST average f1: 0.8835902750500273
[Epoch 2]
Train loss: 0.2274734228849411
0.9369369369369369
Test loss: 0.911078929901123
TEST average_precision: 0.9113986013986013
TEST average recall: 0.8975
TEST average f1: 0.8937888771015706
[Epoch 3]
Train loss: 0.18487520515918732
0.9675925925925924
[Epoch 4]
Train loss: 0.125424325466156
0.9234234234234233
Test loss: 0.4752790331840515
TEST average_precision: 0.9206002886002885
TEST average recall: 0.915
TEST average f1: 0.9118511852784298
[Epoch 5]
Train loss: 0.014186474494636059
1.0
[Epoch 6]
Train loss: 0.08464445173740387
0.9517543859649122
[Epoch 7]
Train loss: 0.007665290962904692
1.0
[Epoch 8]
Train loss: 0.040305331349372864
1.0
[Epoch 9]
Train loss: 0.10694972425699234
0.9871794871794872
[Epoch 10]
Train loss: 0.004810356069356203
1.0
[Epoch 11]
Train loss: 0.0119683388620615
1.0
[Epoch 12]
Train loss: 0.10733649879693985
0.9932432432432432
[Epoch 13]
Train loss: 0.006932160817086697
1.0
[Epoch 14]
Train loss: 0.032485466450452805
0.9945945945945945
Test loss: 0.16748061776161194
TEST average_precision: 0.9256406926406927
TEST average recall: 0.9175
TEST average f1: 0.9176292201090961
[Epoch 15]
Train loss: 0.007920954376459122
1.0
[Epoch 16]
Train loss: 0.2572179436683655
0.990990990990991
Test loss: 0.31431257724761963
TEST average_precision: 0.9271457431457432
TEST average recall: 0.92
TEST average f1: 0.9183735318688878
[Epoch 17]
Train loss: 0.18473130464553833
0.9607843137254901
[Epoch 18]
Train loss: 0.013974683359265327
1.0
[Epoch 19]
Train loss: 0.012683928944170475
1.0
Test loss: 0.534891664981842
TEST average_precision: 0.9377676767676766
TEST average recall: 0.93
TEST average f1: 0.9265976373128075
[Epoch 20]
Train loss: 0.007550037931650877
1.0
[Epoch 21]
Train loss: 0.03438736870884895
0.9907407407407407
[Epoch 22]
Train loss: 0.02006479911506176
0.9912280701754386
[Epoch 23]
Train loss: 0.001688602613285184
1.0
[Epoch 24]
Train loss: 0.019754206761717796
1.0
[Epoch 25]
Train loss: 0.0007257368415594101
1.0
[Epoch 26]
Train loss: 0.025225015357136726
0.9907407407407407
[Epoch 27]
Train loss: 0.008664227090775967
1.0
[Epoch 28]
Train loss: 0.0046028560027480125
1.0
[Epoch 29]
Train loss: 0.12109524011611938
0.972972972972973
Finished Training
avg acc, f1: nan nan
